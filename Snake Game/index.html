<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="Ahmet Hızır Eren">
    <title>PUNCTUAL SNAKE</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=VT323&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">    
</head>
<body>
    <!--
        -sözlük-
        xSpeed:x ekseninde gitme olayı ve hızı (her fps'de 1 ölçü kadar);
        ySpeed:y ekseninde gitme olayı ve hızı (her fps'de 1 ölçü kadar);
        scale:ölçü;
        direction:yön;
    -->
    <div class="sis"></div>
    <article>
        <div class="gameoveralert">
            <h1>TİME İS UP</h1>
            <h1>GAME OVER</h1>
            <h1>YOUR SKOR</h1>
            <h1 class="gameoveralert-p">1</h1>
            <p><button>TRY AGAİN</button></p>
        </div>
        <img src="Screenshot_1-removebg-preview.png" alt="">
        <h1>PUNCTUAL SNAKE</h1>
        <button class="startbutton">
            START
        </button>
        <div class="howtoplay">
            <h1>How To Play</h1>
            <p>Click start button and click any one of direction keys to start</p>
            <p>Try to earn the most points in the limited time. if you eat apple you earn extra time. move with direction keys or direction buttons. Your score determines the time you earn for each apple.</p>
            <p>Author: Ahmet Hızır Eren</p>
            <p><a href="https://www.instagram.com/ahmeren05/?hl=tr">Intagram</a> & <a href="https://twitter.com/ahmeren05">Twitter</a> : @ahmeren05, Mail : <a href="mailto:ahmethizireren@gmail.com">ahmethizireren@gmail.com</a></p>
        </div>
        <canvas width="280" height="280" style="background-color: #275934;">
        </canvas>
        <div class="info">
            <div class="time">
                <p>TİME LEFT:</p>
                <p class="timep"></p>
            </div>
            <div class="score">
                <p>SCORE:</p>
                <p class="scorep"></p>
            </div>
        </div>
        <div class="buttons">
            <button class="topbutton">></button>
            <button class="rightbutton">></button>
            <button class="downbutton">></button>
            <button class="leftbutton">></button>
        </div>
    </article>
    <script>
        var startbutton = document.querySelector(".startbutton")
            startbutton.addEventListener("click",function() {
            document.querySelector(".howtoplay").style.animationName="howtoplay";
            startbutton.style.animationName="howtoplay"
            document.querySelector("img").style.animationName="phoneimg"
            document.querySelector(".score").style.animationName="canvasinfo"
            document.querySelector(".buttons").style.animationName="canvas"
            document.querySelector(".time").style.animationName="canvasinfo"
            document.querySelector("canvas").style.animationName="canvas"
            document.querySelector("article > h1").style.animationName="article1h1"
            bigcheck();
        })
    </script>
    <script> // friut
        function Friut() {
            this.x;
            this.y;

            this.pickLocation = function () { // elmanın konumunu seçiyoruz
                this.x = (Math.floor(Math.random() * rows - 1) + 1) * scale;
                this.y = (Math.floor(Math.random() * columns - 1) + 1) * scale;
            }
            this.draw = function () {
            var apple = new Image();
            apple.src="Screenshot_3.png";
            context.drawImage(apple,this.x, this.y, scale, scale);
            }
        }

    </script>
    <script> // snake
        function Snake (){
            this.x = 100; //x koordinatındaki konumu, ölçünün katı olmak zorunda
            this.y = 100; //y koordinatındaki konumu, ölçünün katı olamk zorunda
            this.xSpeed = 0;
            this.ySpeed = 0;
            this.total = 0;
            this.tail = [];
            var skin = new Image();
            skin.src="NewPiksel4.png";
            this.draw = function() {
                context.fillStyle = "black";
                for (let i = 0; i < this.tail.length; i++) {
                    context.drawImage(skin,this.tail[i].x, this.tail[i].y, scale, scale)
                }
                context.drawImage(skin,this.x, this.y, scale, scale);
            }
            this.update = function() {
                for (let i = 0; i < this.tail.length - 1; i++) {
                    this.tail[i] = this.tail[i+1];                   
                }

                this.tail[this.total - 1] = {x: this.x, y: this.y};


                this.x += this.xSpeed;
                this.y += this.ySpeed;
                if(this.x > canvas.width - 1* scale){
                    this.x=0;
                }
                if(this.x < 0){
                    this.x=canvas.width - 1 * scale;
                }
                if(this.y > canvas.height - 1 * scale){
                    this.y=0;
                }
                if(this.y < 0){
                    this.y=canvas.height - 1 * scale;
                }
            }
            this.chanceDirection = function (direction) {

                switch(direction){ //4 tane olayımız var
                    case 'Up'://yukarı oka basıldığında
                    if (this.ySpeed != scale * 1 ) {
                        this.xSpeed = 0; // x ekseninde hareket olmayacak.
                        this.ySpeed = -scale * 1; // y ekseni eksi ölçü kadar hareket edecek.
                    }
                    break;
                    case 'Down'://aşağı oka basıldığında
                    if (this.ySpeed != -scale * 1) {
                        this.xSpeed = 0; // x ekseninde hareket olmayacak.
                        this.ySpeed = scale * 1; // y ekseni artı ölçü kadar hareket edecek.
                    }
                    break
                    case 'Left'://sol oka basıldığında
                    if (this.xSpeed != scale * 1) {
                        this.ySpeed = 0; // y ekseninde hareket olmayacak.
                        this.xSpeed = -scale * 1; // x ekseni eksi ölçü kadar hareket edecek.
                    }
                    break
                    case 'Right'://yukarı oka basıldığında
                    if (this.xSpeed != -scale * 1) {
                        this.ySpeed = 0; // y ekseninde hareket olmayacak.
                        this.xSpeed = scale * 1; // x ekseni artı ölçü kadar hareket edecek.
                    }
                    break
                }
            }
            var rightbutton = document.querySelector(".rightbutton")
            var leftbutton = document.querySelector(".leftbutton")
            var topbutton = document.querySelector(".topbutton")
            var downbutton = document.querySelector(".downbutton")
            rightbutton.addEventListener("click", function () {
                if (snake.xSpeed != -scale * 1) {
                    snake.ySpeed = 0; 
                    snake.xSpeed = scale * 1; 
                }
                startreducecheck()
            })
            leftbutton.addEventListener("click", function () {
                if (snake.xSpeed != scale * 1) {
                    snake.ySpeed = 0; 
                    snake.xSpeed = -scale * 1; 
                }
                startreducecheck()
            })
            topbutton.addEventListener("click", function () {
                if (snake.ySpeed != scale * 1) {
                    snake.xSpeed = 0; 
                    snake.ySpeed = -scale * 1;
                }
                startreducecheck()
            })
            downbutton.addEventListener("click", function () {
                if (snake.ySpeed != -scale * 1) {
                    snake.xSpeed = 0; // y ekseninde hareket olmayacak.
                    snake.ySpeed = scale * 1; // x ekseni artı ölçü kadar hareket edecek.
                }
                startreducecheck()
            })
            this.eat = function (friut) {
                if(this.x === friut.x && this.y === friut.y){
                    this.total++;
                    return true;
                }
                return false;
            }
        }
    </script>
    <script> // draw
        const canvas = document.querySelector("canvas");
        const context = canvas.getContext("2d");
        const scale = 20;
        const rows = canvas.width / scale;
        const columns = canvas.height / scale;
        var snake;
        var score = document.querySelector(".scorep");
        score.innerHTML =1 ;
        var time = document.querySelector(".timep");
        time.innerHTML = 5;
        timecheck = 5;
        var firstclickcontrol=0;
        (function setup() {
            snake = new Snake();
            friut = new Friut();
            friut.pickLocation();
            window.setInterval(() =>{
                context.clearRect(0, 0, canvas.width, canvas.height);
                snake.draw();
                snake.update();
                friut.draw();
                if(snake.eat(friut)){
                    friut.pickLocation(); // elmaya yeni konum şeç
                    score.innerHTML++;
                    if (score.innerHTML<=10) {
                        timecheck+=3;
                        time.innerHTML=timecheck;    
                    }
                    else if (score.innerHTML>10 && score.innerHTML<=20) {
                        timecheck+=2;
                        time.innerHTML = timecheck
                    }else if (score.innerHTML>20) {
                        timecheck++;
                        time.innerHTML = timecheck;
                    }
                }
                if (time.innerHTML == 0) {
                    gameOver()
                }
            },1000/12)
        })();
        function bigcheck() {
            window.addEventListener("keydown", ((event) => {
            const direction = event.key.replace("Arrow" , '') //yönler dizisi
            snake.chanceDirection(direction); //chanceDirection fonksiyonunu direction değişken(dizi) parametresi ile çalıştır.
            if (direction == "Down" || direction == "Up" || direction == "Right" || direction == "Left") {
                startreducecheck()
            }
        }))
        }
        function startreducecheck() {
            firstclickcontrol++;
            if(firstclickcontrol==1){
                startTime(true);
            }
        }
        function startTime(kontrol) {
            if (kontrol==false) {
                firstclickcontrol=0;
                clearInterval(zaman)
            }else if(kontrol==true){
                zaman = setInterval( function reduceTime() {
                time.innerHTML--;
                timecheck--;    
                }, 1000);
            }
        }
        function gameOver() {
            var point = 0;
            point = score.innerHTML;
            snake = new Snake();
            startTime(false)
            document.querySelector(".sis").style.animationName="sis";
            document.querySelector(".gameoveralert").style.animationName="gameoveralert"
            document.querySelector(".gameoveralert-p").innerHTML=point;
            document.querySelector(".gameoveralert > p > button").addEventListener("click",function() {
                document.querySelector(".sis").style.animationName="sisreverse"
                document.querySelector(".gameoveralert").style.animationName="gameoveralertreverse"
                score.innerHTML=1;
                timecheck=5;
                time.innerHTML=timecheck
                friut.pickLocation();
            })
        }
    </script>
    <script>
        var imgs = document.querySelectorAll("img");
        for (let index = 0; index < imgs.length; index++) {
            imgs[index].oncontextmenu = function (event) {
                event.preventDefault()
                event.stopPropagation()
                return false
            }
        }
        var imgs = document.querySelectorAll('img');
        var i;
        for (i = 0; i < imgs.length; i++) {
            imgs[i].addEventListener('dragstart', (e) => e.preventDefault())
        }
    </script>

</body>

</html>